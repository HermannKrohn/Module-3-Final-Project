<html itemscope itemtype="http://schema.org/Article">
<head>

    <link rel="style-sheet" href="./style.css">

    <!-- <meta name="google-signin-scope" content="profile email">
    <meta name="google-signin-client_id" content="812844936506-u8u9ou3uvgpjkbhg2shr8s69ogi8ssqg.apps.googleusercontent.com">
    <script src="https://apis.google.com/js/platform.js" async defer></script> -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js">
    </script>
    <script src="https://apis.google.com/js/client:platform.js?onload=start" async defer>
    </script>
    <script>
            function start() {
              gapi.load('auth2', function() {
                auth2 = gapi.auth2.init({
                  client_id: '247563481751-5v3guf2mir8tffh60n3k80trolcp7cid.apps.googleusercontent.com',
                  scope: "https://mail.google.com https://www.googleapis.com/auth/calendar"
                  // Scopes to request in addition to 'profile' and 'email'
                  //scope: 'additional_scope'
                });
              });
            }
          </script>
</head>
<body>
    <div class="container">

        <div class="POI-Area column">
            <div class="x">
                1
            </div>
        </div>

        <div class="Calendar-Area column">
            <div class="x" id = "g">
                2
            </div>
        </div>

        <div class="Gmail-Area column">
            <div class="x" >
                3
            </div>
        </div>

        <button id="signinButton">Sign in with Google</button>
        <script>
        $('#signinButton').click(function() {
            // signInCallback defined in step 6.
            auth2.grantOfflineAccess().then(signInCallback);
        });
        function signInCallback(authResult) {
            //console.log(authResult)
            if (authResult['code']) {

                // Hide the sign-in button now that the user is authorized, for example:
                $('#signinButton').attr('style', 'display: none');

                // Send the code to the server
                $.ajax({
                type: 'POST',
                url: 'http://localhost:3000/auth/goggle_oauth2/callback',
                // Always include an `X-Requested-With` header in every AJAX request,
                // to protect against CSRF attacks.
                headers: {
                    'X-Requested-With': 'XMLHttpRequest',
                    'Content-Type': 'application/json'
                },
                contentType: 'application/octet-stream; charset=utf-8',
                success: function(result) {
                  console.log(result,"this");

                  



                //
                // let gmail_container =  document.querySelector("#g")
                // let ul = document.createElement('ul')
                // let sortArray = []
                //
                //
                //     console.log('this is the result', result)
                //     // result.forEach(e => {
                //     for(let i = 0; i<result.length;i++){
                //       console.log(result[i].start.dateTime.split('-')[1]) //string
                //       console.log(result[i+1].start.dateTime.split('-')) //string
                //       for(let j = 0; j<)


                    // }
                      //parseout date, order by start time
                      // obviously, earlier makes it way to the top
                      // AFTER we want to use this sorted array to populate front end div


                      // console.log(e["summary"]);
                      // console.log(e["start"]["dateTime"].split('T'));
                      // console.log(e["end"]["dateTime"].slice(11,16));
                      // let li = document.createElement('li')
                      // li.innerText = e["summary"]
                      // let ul2 = document.createElement('ul')
                      // let date = document.createElement('li')
                      // let li_s = document.createElement('li')
                      // let li_e = document.createElement('li')
                      // date.innerText = e["start"]["dateTime"].split('T')[0]
                      // li_s.innerText = `Starts at ` + e["start"]["dateTime"].slice(11,16)
                      // li_e.innerText = `Ends at ` + e["end"]["dateTime"].slice(11,16)
                      // ul2.append(date,li_s,li_e)
                      // li.append(ul2)
                      //
                      // ul.append(li)
                    // })//forEach
                    //  1st for
                      // gmail_container.append(ul)
                },
                processData: false,
                data: JSON.stringify({ code: authResult['code']} )
                });
            } else {
                // There was an error.
            }
        }
        </script>

        <!-- <a href="#" onclick="signOut();">Sign out</a>
        <div class="g-signin2 bottom-right" data-onsuccess="onSignIn" data-theme="dark"></div>
        <script>
        function onSignIn(googleUser) {
            window.googleUser = googleUser
            // Useful data for your client-side scripts:
            var profile = googleUser.getBasicProfile();
            console.log("ID: " + profile.getId()); // Don't send this directly to your server!
            console.log('Full Name: ' + profile.getName());
            console.log('Given Name: ' + profile.getGivenName());
            console.log('Family Name: ' + profile.getFamilyName());
            console.log("Image URL: " + profile.getImageUrl());
            console.log("Email: " + profile.getEmail());

            // The ID token you need to pass to your backend:
            var id_token = googleUser.getAuthResponse().id_token;
            console.log("ID Token: " + id_token);
        }
        function signOut() {
            var auth2 = gapi.auth2.getAuthInstance();
            auth2.signOut().then(function () {
            console.log('User signed out.');
            });
        }
        </script> -->
    </div>

</body>
</html>
